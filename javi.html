<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>911repair ¬∑ Diagn√≥stico Profesional</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:opsz,wght@14..32,300;14..32,400;14..32,500;14..32,600;14..32,700&display=swap" rel="stylesheet">
    <style>
        /* === MISMOS ESTILOS DE LA APP PRINCIPAL === */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --primary-light: #3b82f6;
            --primary-soft: #eff6ff;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --whatsapp: #25D366;
            
            --bg-primary: #f8fafc;
            --bg-secondary: #ffffff;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #64748b;
            --border: #e2e8f0;
            --border-light: #f1f5f9;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05);
            --shadow-md: 0 10px 15px -3px rgb(0 0 0 / 0.05);
            
            --radius: 20px;
            --radius-sm: 12px;
            --transition: all 0.2s ease;
        }

        [data-theme="dark"] {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;
            --border: #334155;
            --border-light: #1e293b;
            --primary-soft: #1e293b;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.5;
            min-height: 100vh;
            padding: 16px;
            transition: background 0.3s, color 0.3s;
            font-size: 16px;
            -webkit-tap-highlight-color: transparent;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        h1 {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.6rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border);
        }

        h1 i {
            color: var(--primary);
            font-size: 2rem;
        }

        h2 {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
        }

        h2 i {
            color: var(--primary);
            width: 28px;
        }

        /* === TARJETAS === */
        .section {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 20px;
            margin-bottom: 20px;
            transition: var(--transition);
        }

        .section:hover {
            border-color: var(--primary);
            box-shadow: var(--shadow-md);
        }

        .section.blue { border-left: 4px solid var(--primary); }
        .section.green { border-left: 4px solid var(--success); }
        .section.orange { border-left: 4px solid var(--warning); }
        .section.gray { border-left: 4px solid var(--text-muted); }
        .section.red { border-left: 4px solid var(--danger); }

        /* === INFORMACI√ìN === */
        .info-row {
            display: flex;
            align-items: baseline;
            padding: 8px 0;
            border-bottom: 1px dashed var(--border-light);
        }

        .info-row:last-child {
            border-bottom: none;
        }

        .info-label {
            min-width: 140px;
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .info-value {
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        /* === BADGES === */
        .ok, .bad, .warn {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 40px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 8px;
        }

        .ok {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .bad {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .warn {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        /* === BATER√çA === */
        #battery {
            font-size: 1.2rem;
            font-weight: 600;
            background: var(--bg-primary);
            padding: 16px;
            border-radius: 60px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border: 1px solid var(--border);
        }

        /* === GRID DE CAPACIDADES === */
        #caps {
            list-style: none;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 10px;
        }

        #caps li {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 40px;
            padding: 10px 14px;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        /* === BOTONES === */
        button {
            font-family: 'Inter', sans-serif;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 20px;
            border: 1px solid transparent;
            border-radius: 40px;
            font-weight: 500;
            font-size: 0.9rem;
            cursor: pointer;
            transition: var(--transition);
            background: var(--primary);
            color: white;
            width: 100%;
            margin: 4px 0;
        }

        button:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        button:active {
            transform: translateY(0);
        }

        .section.blue button {
            background: var(--primary);
        }

        .section.gray button {
            background: var(--bg-primary);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .section.gray button:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        /* === BOT√ìN VOLVER === */
        button:last-of-type {
            background: var(--bg-primary);
            color: var(--text-primary);
            border: 1px solid var(--border);
            margin-top: 24px;
        }

        button:last-of-type:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        /* === CANVAS === */
        canvas {
            width: 100%;
            height: 120px;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            margin: 16px 0 8px;
        }

        /* === RESULTADOS === */
        #cpuResult, #fpsResult {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 40px;
            padding: 16px 20px;
            font-size: 0.95rem;
            margin-top: 16px;
            text-align: center;
            color: var(--text-primary);
        }

        #result {
            list-style: none;
        }

        #result li {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 40px;
            padding: 12px 18px;
            margin-bottom: 8px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        #result li i {
            color: var(--primary);
            width: 20px;
        }

        /* === GRID DE BOTONES INTERACTIVOS === */
        .button-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }

        .button-grid button {
            margin: 0;
        }

        .button-grid button:last-child {
            grid-column: span 2;
        }

        /* === FOOTER === */
        .small {
            font-size: 0.8rem;
            color: var(--text-muted);
            text-align: center;
            margin-top: 32px;
            padding-top: 16px;
            border-top: 1px solid var(--border);
        }

        /* === RESPONSIVE === */
        @media (max-width: 480px) {
            .info-row {
                flex-direction: column;
                gap: 4px;
            }
            
            .info-label {
                min-width: auto;
            }
            
            #caps {
                grid-template-columns: 1fr;
            }
            
            .button-grid {
                grid-template-columns: 1fr;
            }
            
            .button-grid button:last-child {
                grid-column: span 1;
            }
            
            h1 {
                font-size: 1.3rem;
            }
        }

        /* === ANIMACIONES === */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .loading {
            animation: pulse 1.5s infinite;
        }
    </style>
</head>
<body data-theme="light">
    <div class="container">
        <h1>
            <i class="fas fa-stethoscope"></i>
            Diagn√≥stico Profesional
        </h1>

        <!-- IDENTIFICACI√ìN DEL EQUIPO -->
        <div class="section blue">
            <h2><i class="fas fa-id-card"></i> Identificaci√≥n del equipo</h2>
            <div class="info-row">
                <span class="info-label">Sistema operativo:</span>
                <span class="info-value" id="os"></span>
            </div>
            <div class="info-row">
                <span class="info-label">Plataforma:</span>
                <span class="info-value" id="platform"></span>
            </div>
            <div class="info-row">
                <span class="info-label">N√∫cleos CPU:</span>
                <span class="info-value" id="cpu"></span>
            </div>
            <div class="info-row">
                <span class="info-label">Memoria RAM:</span>
                <span class="info-value" id="ram"></span>
            </div>
            <div class="info-row">
                <span class="info-label">Pantalla:</span>
                <span class="info-value" id="res"></span>
            </div>
            <div class="info-row">
                <span class="info-label">Pantalla t√°ctil:</span>
                <span class="info-value" id="touch"></span>
            </div>
        </div>

        <!-- CONECTIVIDAD -->
        <div class="section green">
            <h2><i class="fas fa-wifi"></i> Estado de red</h2>
            <div class="info-row">
                <span class="info-label">Dispositivo online:</span>
                <span class="info-value" id="online"></span>
            </div>
            <div class="info-row">
                <span class="info-label">Tipo de conexi√≥n:</span>
                <span class="info-value" id="netType"></span>
            </div>
            <div class="info-row">
                <span class="info-label">Velocidad descarga:</span>
                <span class="info-value" id="speed"></span>
            </div>
            <div class="info-row">
                <span class="info-label">Latencia (RTT):</span>
                <span class="info-value" id="rtt"></span>
            </div>
        </div>

        <!-- BATER√çA -->
        <div class="section orange">
            <h2><i class="fas fa-battery-three-quarters"></i> Nivel de energ√≠a</h2>
            <div id="battery">üîç Cargando bater√≠a...</div>
        </div>

        <!-- SENSORES Y CAPACIDADES -->
        <div class="section gray">
            <h2><i class="fas fa-microchip"></i> Sensores & APIs compatibles</h2>
            <ul id="caps"></ul>
        </div>

        <!-- PRUEBA DE CPU -->
        <div class="section gray">
            <h2><i class="fas fa-microchip"></i> Estr√©s de CPU (5s)</h2>
            <button onclick="cpuTest()">
                <i class="fas fa-play"></i> Iniciar prueba de esfuerzo
            </button>
            <div id="cpuResult">‚Äî Pulsa para medir rendimiento ‚Äî</div>
        </div>

        <!-- BENCHMARK GR√ÅFICO -->
        <div class="section gray">
            <h2><i class="fas fa-chart-line"></i> Benchmark gr√°fico</h2>
            <button onclick="startBenchmark()">
                <i class="fas fa-play"></i> Iniciar benchmark
            </button>
            <canvas id="bench" width="300" height="100"></canvas>
            <div id="fpsResult">‚Äî Renderizado no iniciado ‚Äî</div>
        </div>

        <!-- PRUEBAS INTERACTIVAS -->
        <div class="section blue">
            <h2><i class="fas fa-gamepad"></i> Pruebas interactivas</h2>
            <div class="button-grid">
                <button onclick="testVibration()">
                    <i class="fas fa-mobile-alt"></i> Vibraci√≥n
                </button>
                <button onclick="testAudio()">
                    <i class="fas fa-volume-up"></i> Audio
                </button>
                <button onclick="testCamera()">
                    <i class="fas fa-camera"></i> C√°mara
                </button>
                <button onclick="testMic()">
                    <i class="fas fa-microphone"></i> Micr√≥fono
                </button>
                <button onclick="testGPS()">
                    <i class="fas fa-map-marker-alt"></i> GPS / Ubicaci√≥n
                </button>
            </div>
        </div>

        <!-- EVALUACI√ìN T√âCNICA -->
        <div class="section red">
            <h2><i class="fas fa-clipboard-list"></i> Evaluaci√≥n t√©cnica ¬∑ resumen</h2>
            <ul id="result">
                <li><i class="fas fa-info-circle"></i> Los resultados aparecer√°n aqu√≠</li>
            </ul>
        </div>

        <!-- BOT√ìN VOLVER -->
        <button onclick="volverApp()">
            <i class="fas fa-arrow-left"></i> Volver al panel principal
        </button>

        <p class="small">
            <i class="fas fa-microchip"></i> Diagn√≥stico inteligente en navegador ¬∑ Los valores reflejan capacidades detectadas.<br>
            No reemplaza un escaneo f√≠sico especializado.
        </p>
    </div>

    <script>
        (function() {
            // ========== IDENTIFICACI√ìN ==========
            const ua = navigator.userAgent;
            const platform = navigator.platform || "‚Äî";
            document.getElementById("platform").innerText = platform;
            document.getElementById("cpu").innerText = navigator.hardwareConcurrency || "no disponible";
            document.getElementById("ram").innerText = navigator.deviceMemory ? navigator.deviceMemory + " GB" : "no disponible";
            document.getElementById("res").innerText = screen.width + " x " + screen.height;
            
            const touchSupport = navigator.maxTouchPoints > 0 ? 
                '<span class="ok">‚úÖ S√≠ ¬∑ ' + navigator.maxTouchPoints + ' pts</span>' : 
                '<span class="warn">‚ö†Ô∏è No detectada</span>';
            document.getElementById("touch").innerHTML = touchSupport;

            let os = "Desconocido";
            if (ua.includes("Android")) os = "Android";
            else if (ua.includes("iPhone") || ua.includes("iPad")) os = "iOS";
            else if (ua.includes("Windows")) os = "Windows";
            else if (ua.includes("Mac")) os = "macOS";
            else if (ua.includes("Linux")) os = "Linux";
            document.getElementById("os").innerText = os;

            // ========== RED ==========
            document.getElementById("online").innerHTML = navigator.onLine ? 
                '<span class="ok">üü¢ Conectado</span>' : 
                '<span class="bad">üî¥ Sin conexi√≥n</span>';

            const conn = navigator.connection || navigator.mozConnection || navigator.webkitConnection || {};
            document.getElementById("netType").innerText = conn.effectiveType ? conn.effectiveType.toUpperCase() : "N/D";
            document.getElementById("speed").innerText = conn.downlink ? conn.downlink + " Mbps" : "N/D";
            document.getElementById("rtt").innerText = conn.rtt ? conn.rtt + " ms" : "N/D";

            // ========== BATER√çA ==========
            if (navigator.getBattery) {
                navigator.getBattery().then(b => {
                    let nivel = Math.round(b.level * 100);
                    let cargando = b.charging ? "‚ö° En carga" : "üîã Bater√≠a";
                    let colorClass = nivel > 20 ? 'ok' : 'warn';
                    document.getElementById("battery").innerHTML = 
                        `<span>${nivel}%</span>
                        <span class="${colorClass}">${cargando}</span>
                        ${b.charging ? '<i class="fas fa-bolt"></i>' : ''}`;
                });
            } else {
                document.getElementById("battery").innerHTML = '<span class="warn">No se puede medir bater√≠a</span>';
            }

            // ========== CAPACIDADES ==========
            const capsList = document.getElementById("caps");
            capsList.innerHTML = "";

            const features = [
                { name: "Geolocalizaci√≥n", test: "geolocation" in navigator },
                { name: "Vibraci√≥n", test: "vibrate" in navigator },
                { name: "C√°mara", test: "mediaDevices" in navigator },
                { name: "Micr√≥fono", test: "mediaDevices" in navigator },
                { name: "Aceler√≥metro", test: "DeviceMotionEvent" in window },
                { name: "Giroscopio", test: "DeviceOrientationEvent" in window },
                { name: "Bluetooth", test: "bluetooth" in navigator },
                { name: "USB", test: "usb" in navigator },
                { name: "NFC", test: "NDEFReader" in window },
                { name: "Notificaciones", test: "Notification" in window },
                { name: "Service Worker", test: "serviceWorker" in navigator }
            ];

            features.forEach(f => {
                let li = document.createElement("li");
                li.innerHTML = `${f.name} ${f.test ? 
                    '<span class="ok">disponible</span>' : 
                    '<span class="warn">no disponible</span>'}`;
                capsList.appendChild(li);
            });

            // ========== RESULTADOS ==========
            window.addResult = function(name, status) {
                const resultList = document.getElementById("result");
                if (resultList.children.length === 1 && resultList.children[0].innerText.includes("aparecer√°n aqu√≠")) {
                    resultList.innerHTML = "";
                }
                let li = document.createElement("li");
                let icon = 'fa-check-circle';
                if (status.toLowerCase().includes('falla') || status.toLowerCase().includes('no')) {
                    icon = 'fa-exclamation-triangle';
                } else if (status.toLowerCase().includes('ok') || status.toLowerCase().includes('completado')) {
                    icon = 'fa-check-circle';
                } else {
                    icon = 'fa-info-circle';
                }
                li.innerHTML = `<i class="fas ${icon}"></i> <span style="font-weight:600;">${name}:</span> ${status}`;
                resultList.appendChild(li);
            };

            // ========== CPU TEST ==========
            window.cpuTest = function() {
                const start = performance.now();
                let count = 0;
                document.getElementById("cpuResult").innerHTML = '<i class="fas fa-spinner fa-pulse"></i> Procesando durante 5 segundos...';
                
                function heavy() {
                    while (performance.now() - start < 5000) {
                        for (let i = 0; i < 150000; i++) {
                            Math.sqrt(i * i * Math.random());
                            count++;
                        }
                    }
                    const score = Math.round(count / 5);
                    document.getElementById("cpuResult").innerHTML = `<i class="fas fa-microchip"></i> <strong>${score.toLocaleString()}</strong> operaciones/seg ¬∑ estable`;
                    addResult("CPU Stress Test", `Completado ¬∑ ${score.toLocaleString()} ops/seg`);
                }
                setTimeout(heavy, 30);
            };

            // ========== BENCHMARK ==========
            window.startBenchmark = function() {
                const canvas = document.getElementById("bench");
                const ctx = canvas.getContext("2d");
                let frames = 0;
                const start = performance.now();
                canvas.width = canvas.clientWidth || 300;
                canvas.height = canvas.clientHeight || 100;

                function draw() {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    
                    // Fondo
                    ctx.fillStyle = "var(--bg-primary)";
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    // C√≠rculos aleatorios
                    for (let i = 0; i < 12; i++) {
                        ctx.fillStyle = `rgba(37, 99, 235, ${Math.random() * 0.5 + 0.3})`;
                        ctx.beginPath();
                        ctx.arc(
                            Math.random() * canvas.width,
                            Math.random() * canvas.height,
                            Math.random() * 15 + 5,
                            0,
                            Math.PI * 2
                        );
                        ctx.fill();
                    }
                    
                    // Texto
                    ctx.fillStyle = "var(--text-primary)";
                    ctx.font = "bold 12px 'Inter', sans-serif";
                    ctx.fillText("Benchmark en curso...", 15, 30);
                    
                    frames++;
                    
                    if (performance.now() - start < 5000) {
                        requestAnimationFrame(draw);
                    } else {
                        const fps = Math.round(frames / 5);
                        document.getElementById("fpsResult").innerHTML = `<i class="fas fa-chart-line"></i> <strong>${fps}</strong> FPS promedio`;
                        addResult("Benchmark gr√°fico", `Completado ¬∑ ${fps} FPS`);
                    }
                }
                draw();
            };

            // ========== PRUEBAS INTERACTIVAS ==========
            window.testVibration = function() {
                if (!navigator.vibrate) { 
                    addResult("Vibraci√≥n", "No soportada"); 
                    return; 
                }
                navigator.vibrate([200, 100, 200]);
                addResult("Vibraci√≥n", "Ejecutada (patr√≥n 200ms)");
            };

            window.testAudio = function() {
                const audio = new Audio("https://actions.google.com/sounds/v1/alarms/beep_short.ogg");
                audio.play().catch(() => addResult("Audio", "Fall√≥ reproducci√≥n"))
                    .then(() => addResult("Audio", "Sonido emitido"));
            };

            window.testCamera = function() {
                if (!navigator.mediaDevices) { 
                    addResult("C√°mara", "API no disponible"); 
                    return; 
                }
                navigator.mediaDevices.getUserMedia({ video: true })
                    .then(stream => { 
                        stream.getTracks().forEach(t => t.stop()); 
                        addResult("C√°mara", "OK ¬∑ Permiso concedido"); 
                    })
                    .catch(() => addResult("C√°mara", "Falla o denegado"));
            };

            window.testMic = function() {
                if (!navigator.mediaDevices) { 
                    addResult("Micr√≥fono", "API no disponible"); 
                    return; 
                }
                navigator.mediaDevices.getUserMedia({ audio: true })
                    .then(stream => { 
                        stream.getTracks().forEach(t => t.stop()); 
                        addResult("Micr√≥fono", "OK ¬∑ Micr√≥fono funcional"); 
                    })
                    .catch(() => addResult("Micr√≥fono", "Falla o sin permisos"));
            };

            window.testGPS = function() {
                if (!navigator.geolocation) { 
                    addResult("GPS", "No soportado"); 
                    return; 
                }
                navigator.geolocation.getCurrentPosition(
                    () => addResult("GPS", "OK ¬∑ Ubicaci√≥n obtenida"),
                    () => addResult("GPS", "Falla ¬∑ Sin permiso o timeout")
                );
            };

            // ========== VOLVER ==========
            window.volverApp = function() {
                if (confirm("¬øVolver a la aplicaci√≥n principal?")) {
                    window.location.href = "index.html"; 
                }
            };

            // ========== INICIO ==========
            addResult("Sistema", "Diagn√≥stico listo ¬∑ Interact√∫a con las pruebas");
        })();
    </script>
</body>
</html>
